2η Εργασία ΥΣΒΔ

Βρουλιώτης Βασίλειος 1115201300025
Θεολόγη Ιωάννα-Ελένη 1115201300051



Το παραδοτέο αποτελεί μια μικρή εφαρμογή δημιουργίας και διαχείρισης μιας ΒΔ.
Υπάρχουν συναρτήσεις οι οποίες δημιουργούν μια βάση δεδομένω σύμφωνα με τις καταχωρήσεις του χρήστη,συναρτήσεις που επιστρέφουν αποτελέσματα βάσει των στοιχείων που είναι αποθηκευμένα στη ΒΔ,και τέλος συναρτήσεις οι οποίες διαχειρίζονται τη ροή του προγάμματος και τη διεπαφή με τον χρήστη.

Δημιουργούνται 3 λίστες:
-Μία λίστα που περιλαμβάνει όλα τα αρχεία που δημιουργούνται,καθώς και χρήσιμες πληροφορίες γι'αυτά,όπως τον τίτλο τους,μήκος και τύπο κλειδιου/μεταβλητής και τη ρίζα Β+ δένδρου που αντιστοιχεί στο κάθε αρχείο.
-Μία λίστα που περιλάμβάνει όλα τ'ανοιχτά αρχεία και χρήσιμες πληροφορίες γι'αυτά,όπως τον τίτλο και το αναγνωριστικό ανοίγματός τους.
-Μια λιστα που περιλαμβάνει όλα τα αρχεία υπό σάρωση,καθώς και χρήσιμες πληροφορίες γι'αυτά,όπως τον τίτλο και τη θέση τους στη σχετική λίστα.


ΑΜ.c:
Η CreateIndex δημιουργεί ένα αρχείο για το οποίο δεσμεύει ένα αρχικό μπλοκ δεδομένων,και στη συνέχεια το προσθέτει στη λίστα με τα αρχεία.
Η DestroyIndex "καταστρέφει" ένα αρχείο διαγράφοντάς το από τη σχετική λίστα.
Η OpenIndex ανοίγει ένα αρχείο και το προσθέτει στη λίστα με τ'ανοιχτά αρχεία.
Η CloseIndex κλείνει ένα ανοιχτό αρχείο-αν είναι ανοιχτό- και το διαγράφει από τη σχετική λίστα.
Η InsertEntry είναι η συνάρτηση η οποία εισάγει μια εγγραφή στο Β+ δένδρο,και στην ουσία το φτιάχνει μια μια εισαγωγή.Αποτελεί υλοποίηση του αλγορίθμου εισαγωγής στο Β+ δένδρο, όπως αυτός περιγράφεται στο σύγγραμμα "ΘΕΜΕΛΙΩΔΕΙΣ ΑΡΧΕΣ ΣΥΣΤΗΜΑΤΩΝ ΒΑΣΕΩΝ ΔΕΔΟΜΕΝΩΝ" σε μετάφραση του κ.Χατζόπουλου,στις σελίδες 539-540.
Η OpenIdexScan δέχεται ως ορίσματα το αναγνωτιστικό του ανοιχτού αρχείου,	τον τελεστή και την τιμή που θα χρειαστούν για τις συγκρίσεις 
στη σάρωση. Αρχικά, προσθέτει το αρχείο στη λίστα των ανοιχτών σαρώσεών μας, και αφού ολοκληρωθεί επιτυχώς η εισαγωγή καλεί τη συνάρτηση BPTSearch, για να αναζητήσει στα δεδομένα, τη δοσμένη τιμή βάση του τελεστή op.Τέλος, ελέγχει αν στη λίστα σαρώσεων υπάρχουν πάνω από 	MAXSCANS ανοιχτές σαρώσεις. Αν επιτύχει η OpenIndexScan,επιστρέφει την τιμή της θέσης στη λίστα σαρώσεων (position).Στο αρχείο sampleMain.c, κάθε φορά μπορούμε να αλλάζουμε την τιμή του op, και της μεταβλητής testVal που ορίζουμε λίγο πριν το κάλεσμα της συνάρτησης, για να έχουμε διαφορετικές αναζητήσεις.
Η AM_CloseIndexScan	δέχεται ως όρισμα τη θέση που αντιστοιχεί στη λίστα ανοιχτών σαρώσεων. Διαγράφει την ανοιχτή σάρωση από τη λίστα καλώντας τη συνάρτηση deleteanodefromScanList().
Η AM_PrintError δέχεται ως όρισμα, ένα string, το οποίο και θα εκτυπώσει κατευθείαν ως το σφάλμα στη κατάλληλη AM_ συνάρτηση, και μετά εκτυπώνει το τελευταίο σφάλμα που έχει υπάρξει σε συνάρτηση AM, σύμφωνα με την τιμή της  global μεταβλητής AM_errno. Η AM_errno σε κάθε συνάρτηση, θα έχει  δεχθεί την απαραίτητη τιμή σφάλματος, όταν αυτό 	συμβεί.

assistingFunctions.c
Το εν λόγω αρχείο περιλαμβάνει συναρτήσεις οι οποίες εκτελούν διάφορες βοηθητικές λειτουργίες,κυρίως για την InsertEntry,αλλά και γι'άλλες συναρτήσεις που ενεργούν πάνω στο δένδρο.Πρόκειται για συναρτήσεις που υπολογίζουν τον αριθμό των εγγραφών που χωράνε σ'ένα μπλοκ,ανάλογα αν το τελευταίο είναι μπλοκ δεδομένων,μπλοκ-εσωτερικός κόμβος του δένδρου ή μπλοκ-φύλλο του δένδου,συναρτήσεις που μετακινούν τα δεδομένα που είναι γραμμένα σ'ένα μπλοκ αν υπάρχει τετοια ανάγκη,συναρτήσεις που "σπάνε" μπλοκ-κόμβους και μετακινούν τα δεδομένα από το ένα μπλοκ στο άλλο,getters πληροφοριών που βρίσκονται στη λίστα των αρχείων,και άλλες,όπως η  BPTSearch η οποία,αφού καλεστεί από την ΑΜ_OpenIndexScan, θα ξεκινήσει 	από τη ρίζα, και θα ψάξει να βρει,  σύμφωνα με την τιμή 	κλειδιού που της έχουμε περάσει ως όρισμα, το κατάλληλο	μπλοκ δεδομένων. Μόλις το βρει, θα πάει στο συγκεκριμένο	case που υποδεικνύει ο τελεστής σύγκρισης, και θα 	ξεκινήσει την αναζήτηση διασχίζοντας όλες τις τιμές που 	υπάρχουν στο μπλοκ. Οι συγκρίσεις κάθε φορά χωρίζονται 	και ανάλογα με τον τύπο των δεδομένων (αριθμός, 	συμβολοσειρά). Επιστρέφει 1 ή 0 ανάλογα με το αν βρήκε ή 	όχι την τιμή/τιμές που μας ενδιαφέρουν.


filesList.c
Περιλαμβάνει τις συναρτήσεις που χειρίζονται τις 3 προαναφερθείσες λίστες:σχηματισμός,διάσχιση,getters,διαγραφή κόμβου,καταστροφή της σχετικής λίστας,έλεγχος ύπαρξης κ.α

parents.c
Η InsertEntry κάνει χρήση μιας στοίβας γονικών μπλοκ-κόμβων που διασχίζει μέχρι να φθάσει σε φύλλο,σε περίπτωση που προξύψει διάσπαση μπλοκ-κόμβου.Το συγκεκριμένο πηγαίο περιλαμβάνει τις συναρτήσεις που δημιουργούν χειρίζονται τη συγκεκριμένη λίστα.


Για τη μεταγλώττιση χρειάζεται και το -lm για τη σύνδεση της μαθηματικής βιβλιοθήκης της C.